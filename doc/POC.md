# POC: ArgoCD Adoption for AsciiArtify needs

### Description:
This tutorial walks through the installation on Kubernetes + ArgoCD on a local Developer's laptop or VM


### Table of Contents:
1. Kubernetes install on the local laptop/VM
2. ArgoCD install  on the local laptop/VM

### 1. Kubernetes install

- Use the following [link](https://minikube.sigs.k8s.io/docs/start/?arch=%2Fmacos%2Fx86-64%2Fstable%2Fbinary+download) to pick a propper Minikube version
Example of a command to check on a Linux host: `dpkg -l|grep minikube`
- Install Kubernetes: `minikube start`
- Validate: `minikube kubectl -- get po -A`

Example of output:
>NAMESPACE     NAME                                                READY   STATUS    RESTARTS      AGE
>
default       hello-minikube-bbcb89c6c-k4bgk                      1/1     Running   0             27h

>kube-system   coredns-66bc5c9577-nvtfq                            1/1     Running   0             27h

>kube-system   etcd-minikube                                       1/1     Running   0             27h
>
kube-system   kube-apiserver-minikube                             1/1     Running   0             27h
>
kube-system   kube-controller-manager-minikube                    1/1     Running   0             27h
>
kube-system   kube-proxy-ggnmw                                    1/1     Running   0             27h
>
kube-system   kube-scheduler-minikube                             1/1     Running   0             27h
>
kube-system   storage-provisioner                                 1/1     Running   1 (27h ago)   27h


### 2. ArgoCD install  on the local laptop/VM

Run the following commands to deploy ArgoCD into a Kubernetes cluster:

`kubectl create namespace argocd`

`kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/v3.2.0/manifests/install.yaml`

Status of the Kubernetes cluster:

`$ minikube kubectl -- get po -A`

>NAMESPACE     NAME                                                READY   STATUS    RESTARTS      AGE

>argocd        argocd-application-controller-0                     1/1     Running   0             42m
>
argocd        argocd-applicationset-controller-7b6ff755dc-m9ctm   1/1     Running   0             42m
>
argocd        argocd-dex-server-584f7d88dc-n4q8m                  1/1     Running   0             42m
>
argocd        argocd-notifications-controller-67cdd486c6-7smb9    1/1     Running   0             42m
>
argocd        argocd-redis-6dbb9f6cf4-8zpwg                       1/1     Running   0             42m
>
argocd        argocd-repo-server-57bdcb5898-58ckq                 1/1     Running   0             42m
>
argocd        argocd-server-57d9cc9bcf-9bkp4                      1/1     Running   0             42m
>
default       hello-minikube-bbcb89c6c-k4bgk                      1/1     Running   0             27h
>
kube-system   coredns-66bc5c9577-nvtfq                            1/1     Running   0             27h
>
kube-system   etcd-minikube                                       1/1     Running   0             27h
>
kube-system   kube-apiserver-minikube                             1/1     Running   0             27h
>
kube-system   kube-controller-manager-minikube                    1/1     Running   0             27h
>
kube-system   kube-proxy-ggnmw                                    1/1     Running   0             27h
>
kube-system   kube-scheduler-minikube                             1/1     Running   0             27h
>
kube-system   storage-provisioner                                 1/1     Running   1 (27h ago)   27h


**Install ArgoCD client on a Linux host:**


`curl -sSL -o argocd-linux-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64
sudo install -m 555 argocd-linux-amd64 /usr/local/bin/argocd`

Get the autogenerated password for the `admin` user:

`argocd admin initial-password -n argocd`
or
`kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath='{.data.password}' | base64 -d`

**Get access to ArgoCD UI:**

By default, the Argo CD API server is not exposed with an external IP.
Kubectl port-forwarding can be used to connect to the API server without exposing the service.


`kubectl port-forward svc/argocd-server -n argocd 8080:443`

The API server can then be accessed using https://localhost:8080

However, if you run you K8S cluster in VM you can utilize ssh port-forwarding by: `ssh -L 9090:127.0.0.1:8080 username@VM_IP`

and get access to ArgoCD UI: `https://localhost:9090/`

